#- id: ask_temp
#  alias: "\u2018Ask temperature\u2019"
#  trigger:
#  - minutes: '/15'
#    platform: time
#    seconds: 0
#  action:
#  - data:
#      payload: "10"
#      topic: "cmnd/Sonoff2/status"
#    service: mqtt.publish
- id: ask_temp2
  alias: Ask Bedroom temperature mqtt
  trigger:
  - minutes: '/15'
    platform: time
    seconds: 0
  action:
  - data:
      payload: "10"
      topic: "cmnd/Sonoff1/Status"
    service: mqtt.publish

- alias: Turn on corridor light when there is movement
  trigger:
    platform: state
    entity_id: binary_sensor.motion_sensor_158d00016d56c6
    to: 'on'
  action:
    - service: light.turn_on
      data_template:
        entity_id: light.hue_ambiance_candle_1, light.hue_ambiance_candle_2, light.hue_ambiance_candle_3
        brightness_pct: 100

- alias: Turn off corridor light 12 minutes after last movement
  trigger:
    platform: state
    entity_id: binary_sensor.motion_sensor_158d00016d56c6
    to: 'off'
    for:
      minutes: 12
  action:
    service: light.turn_off
    entity_id: light.hue_ambiance_candle_1, light.hue_ambiance_candle_2, light.hue_ambiance_candle_3

- alias: Turn on corridor light when door is opened
  trigger:
    platform: state
    entity_id: binary_sensor.door_window_sensor_158d000171eafd
    to: 'on'
  action:
    - service: light.turn_on
      data_template:
        entity_id: light.hue_ambiance_candle_1, light.hue_ambiance_candle_2, light.hue_ambiance_candle_3
        brightness_pct: 100

- alias: Turn on closet lights on sunset
  trigger:
    platform: sun
    # Possible values: sunset, sunrise
    event: sunset
    # Optional time offset. This example is 45 minutes.
  action:
    - service: homeassistant.turn_on
      entity_id: light.closet_light_left
    - service: homeassistant.turn_on
      entity_id: light.closet_light_right

- alias: Turn off closet lights on sunriset
  trigger:
    platform: sun
    # Possible values: sunset, sunrise
    event: sunrise
    # Optional time offset. This example is 45 minutes.
  action:
    - service: homeassistant.turn_off
      entity_id: light.closet_light_left
    - service: homeassistant.turn_off
      entity_id: light.closet_light_right

- alias: Turn on Christmas lights on sunset
  trigger:
    platform: sun
    # Possible values: sunset, sunrise
    event: sunset
    # Optional time offset. This example is 45 minutes.
  action:
    - service: homeassistant.turn_on
      entity_id: switch.ulko_1
    #- service: homeassistant.turn_on
    #  entity_id: switch.plug_158d0001ded2e0

- alias: Turn off Christmas lights on sunrise
  trigger:
    platform: sun
    # Possible values: sunset, sunrise
    event: sunrise
    # Optional time offset. This example is 45 minutes.
  action:
    - service: homeassistant.turn_off
      entity_id: switch.ulko_1
    #- service: homeassistant.turn_off
    #  entity_id: switch.plug_158d0001ded2e0

- alias: Movie time - single click
  trigger:
    platform: event
    event_type: click
    event_data:
      entity_id: binary_sensor.switch_158d00019ca681
      click_type: single
  action:
    - service: light.turn_on
      entity_id: light.closet_light_left, light.closet_light_right, switch.plug_158d0001ded2e0
    - service: light.turn_off
      entity_id: light.hue_ambiance_candle_1, light.hue_ambiance_candle_2, light.hue_ambiance_candle_3
    - service: switch.turn_off
      entity_id: switch.wall_switch_right_158d0001f423d6, switch.wall_switch_158d000159abf6, switch.wall_switch_left_158d0001f423d6

- alias: Shit going down (ultra toggle) - long press
  trigger:
    platform: event
    event_type: click
    event_data:
      entity_id: binary_sensor.switch_158d00019ca681
      click_type: long_click_press
  action:
    - service: homeassistant.toggle
      entity_id: group.all_lights
    - service: homeassistant.toggle
      entity_id: group.all_switches

- alias: Turn on lights to living room and kitchen - double click
  trigger:
    platform: event
    event_type: click
    event_data:
      entity_id: binary_sensor.switch_158d00019ca681
      click_type: double
  action:
    - service: light.turn_on
      data_template:
        entity_id: light.hue_ambiance_candle_1, light.hue_ambiance_candle_2, light.hue_ambiance_candle_3
        brightness_pct: 100
    - service: switch.turn_on
      entity_id: switch.wall_switch_right_158d0001f423d6, switch.wall_switch_158d000159abf6, switch.wall_switch_left_158d0001f423d6

- alias: Toggle corridor light - Wireless right
  trigger:
    platform: event
    event_type: click
    event_data:
      entity_id: binary_sensor.wall_switch_right_158d0001641c55
      click_type: single
  action:
    - service: light.toggle
      entity_id: light.hue_ambiance_candle_1, light.hue_ambiance_candle_2, light.hue_ambiance_candle_3


- alias: Toggle other - Wireless left
  trigger:
    platform: event
    event_type: click
    event_data:
      entity_id: binary_sensor.wall_switch_left_158d0001641c55
      click_type: single
  action:
    - service: switch.toggle
      entity_id: switch.wall_switch_right_158d0001f423d6, switch.wall_switch_158d000159abf6


- alias: Temperature above 26C
  trigger:
    platform: numeric_state
    entity_id: sensor.Temperature_158d00019ce67e
    above: 26
  condition:
    - condition: state
      entity_id: device_tracker.hostone
      state: 'home'
  action:
    - service: notify.slack
      data_template:
        message: Home temperature above 26'C!
    - service: homeassistant.turn_off
      entity_id: automation.temperature_above_26C


- alias: Nuuksu at home for 5 hours
  trigger:
    platform: state
    entity_id: group.family
    from: 'home'
    to: 'not_home'
    for:
      hours: 5
  condition:
    - condition: state
      entity_id:  device_tracker.hostone
      state: 'home'
  action:
    - service: notify.slack
      data_template:
        message: Nuusku has been home alone for 5 hours


- alias: Nuuksu at home for 6 hours
  trigger:
    platform: state
    entity_id: device_tracker.hostone
    from: 'not_home'
    to: 'home'
    for:
      hours: 6
  condition:
    - condition: state
      entity_id: group.family
      state: 'not_home'
  action:
    - service: notify.slack
      data_template:
        message: Nuusku has been home alone for 6 hours @niko


- alias: Nuuksu at home for 7 hours
  trigger:
    platform: state
    entity_id: group.family
    from: 'home'
    to: 'not_home'
    for:
      hours: 7
  condition:
    - condition: state
      entity_id:  device_tracker.hostone
      state: 'home'
  action:
    - service: notify.slack
      data_template:
        message: Nuusku has been home alone for 7 hours @niko

- alias: Nuuksu at home for 8 hours
  trigger:
    platform: state
    entity_id: group.family
    from: 'home'
    to: 'not_home'
    for:
      hours: 8
  condition:
    - condition: state
      entity_id:  device_tracker.hostone
      state: 'home'
  action:
    - service: notify.slack
      data_template:
        message: Nuusku has been home alone for 8 hours!!!!! @niko

- alias: Reboot Pi if connection lost to router
  trigger:
    platform: state
    entity_id: switch.router
    to: 'off'
    for:
      minutes: 5
  action:
    - service: notify.slack
      data_template:
        message: REBOOT - This was done because HA lost connection to the router @niko
    - service: homeassistant.turn_on
      entity_id: script.reboot_pi

- alias: Restart temperature monitoring next morning 9:30
  trigger:
    platform: time
    at: '09:30:00'
  action:
    - service: homeassistant.turn_on
      entity_id: automation.temperature_above_26C

- alias: Turn lights off when no one at home for 45 min
  trigger:
    platform: state
    entity_id: group.family
    from: 'home'
    to: 'not_home'
    for:
      minutes: 45
  action:
    - service: homeassistant.turn_off
      entity_id: switch.wall_switch_left_158d0001f423d6, switch.wall_switch_right_158d0001f423d6, switch.wall_switch_158d000159abf6, light.bedroom, light.corridor, light.quest_room

- alias: Start HomeKit
  trigger:
    - platform: homeassistant
      event: start
  action:
    - delay: 00:05  # Waits 5 minutes
    - service: homekit.start
